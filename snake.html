<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<canvas id="snake" width="608px" height="608px" style="border: 3px solid black"></canvas>
<script>
    const cvs = document.getElementById('snake');
    const ctx = cvs.getContext('2d');
    //
    const box = 30;
    //
    const ground = new Image();
    ground.src = "star.PNG";
    const foodImg = new Image();
    foodImg.src = "star.PNG";
    //
    let snake = [];
    snake[0] = {x: 9*box,
                y: 10*box
    };
    //
    let food = {
        x: Math.floor(Math.random() * 17 + 1)* box,
        y: Math.floor(Math.random() * 15 + 3)* box
    };
    let eat,up,left,right,down;
//
    let score = 0;

    let d;
    document.addEventListener("keydown",direction);
    function direction(event) {
        if (event.keyCode == 37 && d != "Right") {
            left.play();
            d = "Left";
        }else if (event.keyCode == 38 && d != "Down") {
            d = "Up";
            up.play();
        }else if (event.keyCode == 39 && d != "Left") {
            d = "Right";
            right.play();
        }else if (event.keyCode == 40 && d != "Up") {
            d = "Down";
            down.play();
        }
    }
    function collision(head, array) {
        for (let i = 0; i < array.length; i++) {
            if (head.x == array[i].x && head.y == array[i].y) {
                return true;
            }
        }
            return false;
    }
    //
    function draw() {
        ctx.drawImage(ground, 0, 0);
        for (let i = 0; i < snake.length; i++) {
            ctx.fillStyle = (i == 0) ? "green" : "white";
            ctx.fillRect(snake[i].x, snake[i].y, box, box);
            ctx.strokeStyle = "red";
            ctx.strokeRect(snake[i].x, snake[i].y, box, box);
        }
        ctx.drawImage(foodImg, food.x, food.y);
        // Vi tri dau snake;
        let snakeX = snake[0].x;
        let snakeY = snake[0].y;
        // Xoa 1 o duoi khi di chuyen;
        snake.pop();
        if (d = 'Left') snakeX -= box;
        if (d = 'Up') snakeX -= box;
        if (d = 'Right') snakeY += box;
        if (d = 'Down') snakeY += box;

        if (snakeX == food.x && snakeY == food.y) {
            score++;
            eat.play();
            food = {
                x: Math.floor(Math.random() * 17 + 1) * box,
                y: Math.floor(Math.random() * 15 + 3) * box,
            }
        } else {
            snake.pop();
        }
        if (snakeX < box || snakeX > 17 * box || snakeY < 3 * box || snakeY > 17 * box || collision(newHead, snake)) {
            clearInterval(game);
        }
        let newHead = {
            x: snakeX,
            y: snakeY
        }
        snake.unshift(newHead);


        ctx.fillStyle = "white";
        ctx.font = "45px Changa One";
        ctx.fillText(score, 2 * box, 2 * box);
    }
        let game = setInterval(draw,100);


</script>
</body>
</html>